path: ../rabbitmq-perf-test-2
command: ./bin/start

buildpack: java_buildpack
memory: 512M
disk_quota: 256M

no-route: true
health-check-type: none

env:
  METRICS_SAMPLING_INTERVAL: 60
  PRODUCERS: 0
  CONSUMERS: 0
  MSG_SIZE: 1000
  MSG_FLAG: persistent
  QUEUE_PATTERN: 'perf-test-%03d'
  NUMBER_OF_QUEUES_PER_PERFTEST_INSTANCE: 100
  QOS: 10
  MULTI_ACK_EVERY: 10
  CONFIRM_EVERY: 10
  CONFIRM_TIMEOUT: 30
  AUTO_DELETE: false
  PRODUCE_RATE: 5
  CONSUME_RATE: 0.1

services:
  - rmq

applications:
  - name: produce
    instances: 5
    env:
      PRODUCERS: 100

  - name: consume
    instances: 5
    env:
      CONSUMERS: 300
